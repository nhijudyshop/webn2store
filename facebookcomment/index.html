<!doctype html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Facebook Comments Viewer - Real-time</title>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Shared Common CSS -->
    <link rel="stylesheet" href="../shared/styles/common.css" />
    
    <!-- Page-specific CSS -->
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <!-- Sidebar s·∫Ω t·ª± ƒë·ªông load b·ªüi sidebar.js -->

    <div class="container">
        <div class="header">
            <h1>üí¨ Facebook Comments - Real-time Viewer</h1>

            <form id="videoLoadForm" onsubmit="return false;">
                <div class="controls">
                    <div class="form-group">
                        <label for="selectedPageId">Ch·ªçn Page:</label>
                        <select id="selectedPageId">
                            <option value="">ƒêang t·∫£i danh s√°ch pages...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="videoLimit">S·ªë video:</label>
                        <input type="number" id="videoLimit" value="10" min="1" max="50" />
                    </div>

                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button type="button" class="btn btn-primary" onclick="loadVideos(event)">
                            üé• T·∫£i Video
                        </button>
                    </div>
                </div>
            </form>

            <div class="controls" style="margin-top: 15px">
                <div class="form-group" style="grid-column: 1 / -1">
                    <label for="selectedVideoId">Ch·ªçn Video/Post:</label>
                    <select id="selectedVideoId">
                        <option value="">Ch·ªçn page v√† nh·∫•n "T·∫£i Video" tr∆∞·ªõc...</option>
                    </select>
                </div>
            </div>

            <div class="controls">
                <div class="form-group">
                    <label for="connectionMode">Ch·∫ø ƒë·ªô k·∫øt n·ªëi:</label>
                    <select id="connectionMode">
                        <option value="stream">üåä EventStream (Real-time, khuy√™n d√πng)</option>
                        <option value="polling">üîÑ Polling (Auto-refresh)</option>
                    </select>
                </div>

                <div class="form-group" id="refreshIntervalGroup">
                    <label for="refreshInterval">Auto-refresh (gi√¢y):</label>
                    <input type="number" id="refreshInterval" placeholder="VD: 10" value="10" min="5" max="300" />
                </div>

                <div class="form-group button-container">
                    <label>&nbsp;</label>
                    <div class="button-group">
                        <button id="startBtn" onclick="startFetching()">‚ñ∂Ô∏è B·∫Øt ƒê·∫ßu</button>
                        <button id="stopBtn" onclick="stopFetching()" disabled>‚è∏Ô∏è D·ª´ng</button>
                        <button id="refreshOrdersBtn" onclick="refreshOrders()">üîÑ Refresh Orders</button>
                        <button id="clearBtn" onclick="clearComments()">üóëÔ∏è X√≥a</button>
                    </div>
                </div>
            </div>
            
            <div class="controls" style="margin-top: 15px">
                <div class="form-group" style="grid-column: 1 / -1;">
                    <button id="clearSessionBtn" onclick="clearLastSession()" class="btn-clear-session">
                        <i data-lucide="save"></i> X√≥a Session
                    </button>
                </div>
            </div>

            <!-- Search Box -->
            <div class="controls" style="margin-top: 15px">
                <div class="search-container">
                    <i data-lucide="search" class="search-icon"></i>
                    <input
                        type="text"
                        id="searchBox"
                        class="search-box"
                        placeholder="üîç T√¨m ki·∫øm theo t√™n, comment, s·ªë ƒëi·ªán tho·∫°i, ƒë·ªãa ch·ªâ, session, code..."
                    />
                    <button class="clear-search" id="clearSearch">
                        <i data-lucide="x"></i>
                    </button>
                    <div class="search-stats" id="searchStats"></div>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalComments">0</div>
                    <div class="stat-label">T·ªïng comments</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="newComments">0</div>
                    <div class="stat-label">Comments m·ªõi</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="filteredComments">0</div>
                    <div class="stat-label">K·∫øt qu·∫£ t√¨m ki·∫øm</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="lastUpdate">--:--:--</div>
                    <div class="stat-label">C·∫≠p nh·∫≠t l·∫ßn cu·ªëi</div>
                </div>
            </div>
        </div>

        <div id="errorContainer"></div>

        <div class="comments-container">
            <div class="comments-header">
                <div class="comments-title">üí¨ Danh s√°ch Comments</div>
                <div class="refresh-indicator" id="refreshIndicator">
                    <span id="refreshStatus">Ch∆∞a b·∫Øt ƒë·∫ßu</span>
                </div>
            </div>

            <div class="comments-list" id="commentsList">
                <div class="empty-state">
                    <div class="empty-state-icon">üí¨</div>
                    <p>Nh·∫•n "B·∫Øt ƒê·∫ßu" ƒë·ªÉ xem comments real-time</p>
                </div>
            </div>
        </div>

        <!-- Pagination Controls (Hidden by default, shown for Polling mode) -->
        <div class="pagination-controls" id="paginationControls" style="display: none;">
            <button id="prevPageBtn" onclick="goToPage(currentPage - 1)" disabled>
                <i data-lucide="chevron-left"></i> Trang tr∆∞·ªõc
            </button>
            <span id="pageInfo" class="pagination-info">Trang 1/1</span>
            <button id="nextPageBtn" onclick="goToPage(currentPage + 1)" disabled>
                Trang sau <i data-lucide="chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- JavaScript -->
    <!-- Shared Sidebar JS -->
    <script src="../shared/sidebar/sidebar.js"></script>
    
    <!-- Shared API Service (for TPOS) -->
    <script src="../../shared/api/tpos-api.js"></script>
    
    <!-- Page JS -->
    <script type="module" src="app.js"></script>
</body>
</html>